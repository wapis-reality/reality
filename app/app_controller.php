<?phpclass AppController extends Controller{    var $components = array('Session');    var $helpers = array();    function beforeFilter()    {        $user = $this->Session->read('user');        if ($user) {            $this->logged_user = $user;            $this->set('logged_user', $user);        } else {            $this->logged_user = false;            $this->set('logged_user', false);            if (!in_array($this->params['url']['url'], array('login/', 'forgotten_password/', 'forgotten_password_confirm/'))) {                if($this->params["controller"] == "system" && $this->params["action"] != 'login') {                    $this->redirect('/login');                }            }        }    }}